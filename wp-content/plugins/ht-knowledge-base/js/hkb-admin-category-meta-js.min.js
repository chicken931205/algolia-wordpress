jQuery(document).ready((function(t){"use strict";var e=window.meta_image,i=window.wp;function n(){t("input#meta-image").val(""),t("#meta-image-preview").attr("src",e.no_image)}function o(){n(),t("#meta-image-preview").hide()}function a(){t("input#meta-svg").val(""),t("input#meta-svg-color").val(""),t("#ht-kb-svg-preview").html(""),t("#ht-kb-svg-preview").hide(),t("#meta-image-preview").show()}function c(){o(),t("#ht-kb-svg-preview").show()}function r(){return t(".icon-color").val()}t("#meta-image-button").click((function(e){e.preventDefault(),void 0!==i&&i.media&&i.media.editor&&i.media.editor.open("meta-image-button"),window.currentEditor=i.media.editor.get("meta-image-button");i.media.editor.send.attachment;i.media.editor.send.attachment=function(e,i){if(i.hasOwnProperty("id")&&(t("input#meta-image").val(i.id),a(),i.hasOwnProperty("sizes"))){var n=i.sizes,o=null;n.hasOwnProperty("thumbnail")?(o=n.thumbnail.url,t("#meta-image-preview").attr("src",o)):(o=n.full.url,t("#meta-image-preview").attr("src",o))}},window.original_send_to_editor=window.send_to_editor,window.send_to_editor=function(t){}})),t("#meta-image-remove").click((function(t){t.preventDefault(),n(),a()})),t(".meta-color").wpColorPicker(),""!==t("input#meta-svg").val()?c():a(),t("form#addtag input#submit").click((function(t){t.preventDefault(),n(),a()})),t(document.body).on("click","#meta-image-button",(function(i){var n=0;if(0===n){var o=e.activate_tab_text||"";t(".media-menu-item").filter((function(){return t(this).text().toLowerCase().indexOf(o.toLowerCase())>=0})).first().trigger("click"),n=1}})),t(document.body).on("click","li.ht-kb-icon",(function(e){e.preventDefault(),t("li.ht-kb-icon.active").removeClass("active"),t(this).addClass("active"),t("button.media-button-select").on("change",(function(t){t.preventDefault()})),t("button.media-button-select").prop("disabled",!1)})),t(document.body).on("click","button.media-button-select",(function(e){c();var i=t("li.ht-kb-icon.active").html(),n=r();t("#ht-kb-svg-preview").show(),t("#ht-kb-svg-preview").html(i),t("input#meta-svg").val(i),t("input#meta-svg-color").val(n),o(),window.currentEditor.close()}));i.media.view.EmbedUrl;var s=i.media.View,l=s.extend({tagName:"label",className:"add-ht-kb-icon",template:i.template("hkb-icons"),events:{input:"icon",keyup:"icon",change:"icon"},initialize:function(){this.model.get("icon")&&_.delay(_.bind((function(){this.model.trigger("change:icon")}),this),500),this.render()},render:function(){return this.model.set("icon","test"),s.prototype.render.apply(this,arguments),u(),this},icon:function(t){this.model.set("icon","test")},focus:function(){var t=this.$input;t.is(":visible")&&t.focus()[0].select()}}),d=i.media.view.MediaFrame.Post;function m(e){t(".hkbiconsvg-stroke").css("stroke",e),t(".hkbiconsvg-fill").css("fill",e)}function u(){t(".icon-color").wpColorPicker({change:function(e,i){e.target;var n=i.color.toString();m(n),t(".icon-color").val(n)}})}i.media.view.MediaFrame.Post=d.extend({initialize:function(){d.prototype.initialize.apply(this,arguments);var t;this.options;this.states.add([new i.media.controller.Embed({id:"ht-kb-icon",title:"Knowledge Base Icon",content:"icon"})]),t={content:{icon:"iconContent"}},_.each(t,(function(t,e){_.each(t,(function(t,i){this.on(e+":render:"+i,this[t],this)}),this)}),this)},iconContent:function(){var e=new l({controller:this,model:this.state()}).render();this.content.set(e);var i=t("input#meta-svg-color").val()||"#000";t(".icon-color").val(i),m(r()),u()},destroy:function(){}})}));