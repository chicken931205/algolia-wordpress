jQuery(document).ready((function(e){"use strict";e("input#tabindex").val();var t="",n=window.settingsPageObjects;function a(t){e("#hkb-settings-tabs a").removeClass("active"),e("#hkb-settings-tabs a#"+t+"-link").addClass("active"),e(".hkb-settings-section").each((function(n,a){var i=e(a);t==a.id?(i.show(),i.addClass("active")):(i.removeClass("active"),i.hide())})),e("input#activetab").val(t),history.pushState?history.pushState(null,null,"#"+t):location.hash="#"+t}e("#hkb-settings-tabs a").click((function(t){t.preventDefault(),a(e(this).attr("href").substring(1))})),window.addEventListener("hashchange",(function(e){location.hash.length>1&&a(location.hash.substring(1))}),!1);var i,s,r,l,o=e("#activetab").val(),c=window.location.hash.replace("#","");function u(){return e(".ht-knowledge-base-settings-display-sub-cats__input").attr("checked")?(e(".ht-knowledge-base-settings-sub-cat-depth__input").parents("tr").show(400),void e(".ht-knowledge-base-settings-display-sub-cat-articles__input").parents("tr").show(400)):(e(".ht-knowledge-base-settings-sub-cat-depth__input").parents("tr").hide(400),void e(".ht-knowledge-base-settings-display-sub-cat-articles__input").parents("tr").hide(400))}function g(){return e(".ht-knowledge-base-settings-enable-article-feedback__input").attr("checked")?(e(".ht-knowledge-base-settings-enable-anon-article-feedback__input").parents("tr").show(400),e(".ht-knowledge-base-settings-enable-upvote-article-feedback__input").parents("tr").show(400),void e(".ht-knowledge-base-settings-enable-downvote-article-feedback__input").parents("tr").show(400)):(e(".ht-knowledge-base-settings-enable-anon-article-feedback__input").parents("tr").hide(400),e(".ht-knowledge-base-settings-enable-upvote-article-feedback__input").parents("tr").hide(400),void e(".ht-knowledge-base-settings-enable-downvote-article-feedback__input").parents("tr").hide(400))}function d(){return"custom"!=e(".ht-knowledge-base-settings-sortby__input").val()?void e(".ht-knowledge-base-settings-sort-order__input").parents("tr").show(400):void e(".ht-knowledge-base-settings-sort-order__input").parents("tr").hide(400)}function b(){var a=e(".ht-knowledge-base-settings-kb-article-slug__input").val().replace(/\/+$/,""),i=e(".ht-knowledge-base-settings-kb-category-slug__input").val().replace(/\/+$/,""),s=e(".ht-knowledge-base-settings-kb-tag-slug__input").val().replace(/\/+$/,""),r=!0;return r=r&&function(e,a,i){var s=!0;return s=s&&e!=a,s=s&&e!=i,s=s&&a!=i,!!s||(t=n.conflictedSlugError,!1)}(a,i,s),r=r&&function(e,a,i){var s=!0,r=h(e),l=h(a),o=h(i);return s=s&&e!=l,s=s&&e!=o,s=s&&a!=r,s=s&&a!=o,s=s&&i!=r,s=s&&i!=l,!!s||(t=n.heirachicalSlugError,!1)}(a,i,s),(r=(r=(r=(r=(r=(r=r&&p(a))&&p(i))&&p(s))&&_(a))&&_(i))&&_(s))?(e(".hkba-settingsmain__content > form").find(":input[type=submit]").prop("disabled",!1),v("")):(e(".hkba-settingsmain__content > form").find(":input[type=submit]").prop("disabled",!0),v(t)),r}function h(e){var t=e.indexOf("/");return t<0?e:e.substring(0,t)}function p(a){return!(e.inArray(a,n.reservedTerms)>=0)||(t=n.reservedTermError,!1)}function _(a){return!(e.inArray(a,n.existingPostNames)>=0)||(t=n.slugInUseError,!1)}function k(t){e(t).blur((function(){e(this).val(e(this).val().toLowerCase().replace(/ /g,"-").replace(/[^\w-\/]+/g,"")),b()||(e(this).focus(),e(this).select())}))}function v(t){t||(t=""),e(".hkb-settings-infoarea").html(t)}""!==c&&(o=c),""===o||(i=o,r=e("#hkb-settings-tabs a"),l=[],e.each(r,(function(t,n){l.push(e(n).attr("id"))})),s=l,e.inArray(i+"-link",s)<0)?a("general-section"):a(o),e(".ht-knowledge-base-settings-display-sub-cats__input").change((function(){u()})),u(),e(".ht-knowledge-base-settings-display-live-search__input").change((function(){})),e(".ht-knowledge-base-settings-enable-article-feedback__input").change((function(){g()})),g(),e(".ht-knowledge-base-settings-sortby__input").change((function(){d()})),d(),e(".ht-validate-number-input").blur((function(){var t=e(this),n=t.val(),a=t.data("lower-limit"),i=t.data("upper-limit");Math.floor(n)==n&&e.isNumeric(n)&&n<=i&&n>=a||(alert(t.data("validation-requirements")),t.focus())})),k(".ht-knowledge-base-settings-kb-article-slug__input"),k(".ht-knowledge-base-settings-kb-tag-slug__input "),k(".ht-knowledge-base-settings-kb-category-slug__input"),e(".hkba-settingsmain__content > form").submit((function(e){b()||e.preventDefault()}));new function(){var e,t=function(e){!function(){for(var e=document.querySelectorAll(".hkb-btngroup__btn"),t=0;t<e.length;t++){e[t].classList.remove("active"),e[t].parentElement.checked=!1;var n=e[t].getAttribute("data-tab");document.getElementById(n).classList.remove("active")}}(),e.target.classList.add("active");var t=e.currentTarget.getAttribute("data-tab");document.getElementById(t).classList.add("active"),e.target.parentElement.checked=!0};!function(){for(var e=document.querySelectorAll(".hkb-btngroup__btn"),n=0;n<e.length;n++)e[n].addEventListener("click",t,!1)}(),e=document.querySelectorAll("input.hkb-btngroup__radio:checked")[0].value,document.getElementById(e).classList.add("active")};e((function(){e(".hkb-colorpicker").wpColorPicker()})),e(document).on("click",".hkb-bgimageselect__btn",(function(t){t.preventDefault();var n=e(this),a=wp.media.frames.file_frame=wp.media({title:"Select or upload an image",library:{type:"image"},button:{text:"Select"},multiple:!1});a.on("select",(function(){var e=a.state().get("selection").first().toJSON();if("image"==e.type){n.siblings(".hkb-bgimageselect__id").val(e.id).change();var t=e.sizes.hasOwnProperty("thumbnail")?e.sizes.thumbnail.url:e.sizes.full.url;n.siblings(".hkb-bgimageselect__preview").attr("src",t).change()}})),a.open()})),e(document).on("click",".hkb-bgimageselect__remove",(function(t){t.preventDefault();var n=e(this);n.siblings(".hkb-bgimageselect__id").val(0).change();var a=n.siblings(".hkb-bgimageselect__preview"),i=a.attr("data-fallback");a.attr("src",i).change()}))}));